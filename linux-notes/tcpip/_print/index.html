<!doctype html>
<html lang="zh-cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.101.0" />
<link rel="canonical" type="text/html" href="https://blog.huweihuang.com/linux-notes/tcpip/">
<link rel="alternate" type="application/rss&#43;xml" href="https://blog.huweihuang.com/linux-notes/tcpip/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>TCP/IP | 胡伟煌</title>
<meta name="description" content="">
<meta property="og:title" content="TCP/IP" />
<meta property="og:description" content="Kubernetes学习笔记" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blog.huweihuang.com/linux-notes/tcpip/" /><meta property="og:site_name" content="胡伟煌" />

<meta itemprop="name" content="TCP/IP">
<meta itemprop="description" content="Kubernetes学习笔记"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="TCP/IP"/>
<meta name="twitter:description" content="Kubernetes学习笔记"/>




<link rel="preload" href="/scss/main.min.79e3930541ca05b5395c14b2a313b798fad1dc69f9a14aefa57b62eaa9f65f14.css" as="style">
<link href="/scss/main.min.79e3930541ca05b5395c14b2a313b798fad1dc69f9a14aefa57b62eaa9f65f14.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-114718458-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="64" height="64"><path d="M15.9.476a2.14 2.14.0 00-.823.218L3.932 6.01c-.582.277-1.005.804-1.15 1.432L.054 19.373c-.13.56-.025 1.147.3 1.627q.057.087.12.168l7.7 9.574c.407.5 1.018.787 1.662.784h12.35c.646.001 1.258-.3 1.664-.793l7.696-9.576c.404-.5.555-1.16.4-1.786L29.2 7.43c-.145-.628-.57-1.155-1.15-1.432L16.923.695A2.14 2.14.0 0015.89.476z" fill="#326ce5"/><path d="M16.002 4.542c-.384.027-.675.356-.655.74v.188c.018.213.05.424.092.633a6.22 6.22.0 01.066 1.21c-.038.133-.114.253-.218.345l-.015.282c-.405.034-.807.096-1.203.186-1.666.376-3.183 1.24-4.354 2.485l-.24-.17c-.132.04-.274.025-.395-.04a6.22 6.22.0 01-.897-.81 5.55 5.55.0 00-.437-.465l-.148-.118c-.132-.106-.294-.167-.463-.175a.64.64.0 00-.531.236c-.226.317-.152.756.164.983l.138.11a5.55 5.55.0 00.552.323c.354.197.688.428.998.7a.74.74.0 01.133.384l.218.2c-1.177 1.766-1.66 3.905-1.358 6.006l-.28.08c-.073.116-.17.215-.286.288a6.22 6.22.0 01-1.194.197 5.57 5.57.0 00-.64.05l-.177.04h-.02a.67.67.0 00-.387 1.132.67.67.0 00.684.165h.013l.18-.02c.203-.06.403-.134.598-.218.375-.15.764-.265 1.162-.34.138.008.27.055.382.135l.3-.05c.65 2.017 2.016 3.726 3.84 4.803l-.122.255c.056.117.077.247.06.376-.165.382-.367.748-.603 1.092a5.58 5.58.0 00-.358.533l-.085.18a.67.67.0 00.65 1.001.67.67.0 00.553-.432l.083-.17c.076-.2.14-.404.192-.61.177-.437.273-.906.515-1.196a.54.54.0 01.286-.14l.15-.273a8.62 8.62.0 006.146.015l.133.255c.136.02.258.095.34.205.188.358.34.733.456 1.12a5.57 5.57.0 00.194.611l.083.17a.67.67.0 001.187.131.67.67.0 00.016-.701l-.087-.18a5.55 5.55.0 00-.358-.531c-.23-.332-.428-.686-.6-1.057a.52.52.0 01.068-.4 2.29 2.29.0 01-.111-.269c1.82-1.085 3.18-2.8 3.823-4.82l.284.05c.102-.093.236-.142.373-.138.397.076.786.2 1.162.34.195.09.395.166.598.23.048.013.118.024.172.037h.013a.67.67.0 00.841-.851.67.67.0 00-.544-.446l-.194-.046a5.57 5.57.0 00-.64-.05c-.404-.026-.804-.092-1.194-.197-.12-.067-.22-.167-.288-.288l-.27-.08a8.65 8.65.0 00-1.386-5.993l.236-.218c-.01-.137.035-.273.124-.378.307-.264.64-.497.99-.696a5.57 5.57.0 00.552-.323l.146-.118a.67.67.0 00-.133-1.202.67.67.0 00-.696.161l-.148.118a5.57 5.57.0 00-.437.465c-.264.302-.556.577-.873.823a.74.74.0 01-.404.044l-.253.18c-1.46-1.53-3.427-2.48-5.535-2.67.0-.1-.013-.25-.015-.297-.113-.078-.192-.197-.218-.332a6.23 6.23.0 01.076-1.207c.043-.21.073-.42.092-.633v-.2c.02-.384-.27-.713-.655-.74zm-.834 5.166-.2 3.493h-.015c-.01.216-.137.4-.332.504s-.426.073-.6-.054l-2.865-2.03a6.86 6.86.0 013.303-1.799c.234-.05.47-.088.707-.114zm1.668.0c1.505.187 2.906.863 3.99 1.924l-2.838 2.017c-.175.14-.415.168-.618.072s-.333-.3-.336-.524zm-6.72 3.227 2.62 2.338v.015c.163.142.234.363.186.574s-.21.378-.417.435v.01l-3.362.967a6.86 6.86.0 01.974-4.34zm11.753.0c.796 1.295 1.148 2.814 1.002 4.327l-3.367-.97v-.013c-.21-.057-.37-.224-.417-.435s.023-.43.186-.574l2.6-2.327zm-6.404 2.52h1.072l.655.832-.238 1.04-.963.463-.965-.463-.227-1.04zm3.434 2.838c.045-.005.1-.005.135.0l3.467.585c-.5 1.44-1.487 2.67-2.775 3.493l-1.34-3.244a.59.59.0 01.509-.819zm-5.823.015c.196.003.377.104.484.268s.124.37.047.55v.013l-1.332 3.218C11 21.54 10.032 20.325 9.517 18.9l3.437-.583c.038-.004.077-.004.116.0zm2.904 1.4a.59.59.0 01.537.308h.013l1.694 3.057-.677.2c-1.246.285-2.547.218-3.758-.194l1.7-3.057c.103-.18.293-.29.5-.295z" fill="#fff" stroke="#fff" stroke-width=".055"/></svg></span><span class="font-weight-bold">胡伟煌</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/kubernetes-notes/" ><span>Kubernetes学习笔记</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/k8s-source-code-analysis/" ><span>Kubernetes源码分析</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/golang-notes/" ><span>Golang学习笔记</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/linux-notes/" ><span class="active">Linux学习笔记</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/about/" ><span>About</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; 站内搜索…"
  aria-label="站内搜索…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.6eaa81ab0a8b3a66766c2540d0af6114.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href="#" onclick="print();return false;">点击此处打印</a>.
</p><p>
<a href="/linux-notes/tcpip/">返回本页常规视图</a>.
</p>
</div>



<h1 class="title">TCP/IP</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-c629a2b6a83fee825cbde9907286afdd">TCPIP基础</a></li>


    
  
    
    
	
<li>2: <a href="#pg-f7cbb4c5a76ec9332d300cd3470493c2">IP协议</a></li>


    
  
    
    
	
<li>3: <a href="#pg-783f0fab77205aefe1fd803e53ba7c52">TCP协议</a></li>


    
  
    
    
	
<li>4: <a href="#pg-84452cfe31915d8c4f4d04258246cb10">UDP协议</a></li>


    
  
    
    
	
<li>5: <a href="#pg-0890a784034f82778864893ae61492de">HTTP协议</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-c629a2b6a83fee825cbde9907286afdd">1 - TCPIP基础</h1>
    
	<h1 id="1-基础知识">1. 基础知识</h1>
<h2 id="1-1-协议">1.1. 协议</h2>
<p>计算机与网络设备要相互通信，必须基于相同的方法。比如，如何探测到通信目标，使用哪种语言通信，如何结束通信等规则要事先确定。</p>
<p>不同硬件，操作系统之间的通信都需要一种规则，我们将这种<code>事先约定好的规则称之为协议</code>。</p>
<h2 id="1-2-地址">1.2. 地址</h2>
<p>地址：在某一范围内确认的唯一标识符，即数据包传到某一个范围，需要有一个明确唯一的目标地址。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>层</th>
<th>地址</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>端口号</td>
<td>传输层</td>
<td>程序地址</td>
<td>同一个计算机中不同的应用程序</td>
</tr>
<tr>
<td>IP地址</td>
<td>网络层</td>
<td>主机地址</td>
<td>识别TCP/IP网络中不同的主机或路由器</td>
</tr>
<tr>
<td>MAC地址</td>
<td>数据链路层</td>
<td>物理地址</td>
<td>在同一个数据链路中识别不同的计算机</td>
</tr>
</tbody>
</table>
<h2 id="1-3-网络构成">1.3. 网络构成</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/network.png" width="70%">
<table>
<thead>
<tr>
<th>构成要素</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>网卡</td>
<td>连入网络必须使用网卡，又称网络接口卡。</td>
</tr>
<tr>
<td>中继器</td>
<td>OSI第1层，物理层上延长网络的设备，将电缆的信号放大传给另一个电缆。</td>
</tr>
<tr>
<td>网桥/2层交换机</td>
<td>OSI第2层，数据链路层面上连接两个网络的设备，识别数据帧的内容并转发给相邻的网段，根据MAC地址进行处理。</td>
</tr>
<tr>
<td>路由器/3层交换机</td>
<td>OSI第3层，网络层面连接两个网络并对分组报文进行转发，根据IP进行处理。</td>
</tr>
<tr>
<td>4-7层交换机</td>
<td>传输层到应用层，以TCP等协议分析收发数据，负载均衡器就是其中一种。</td>
</tr>
<tr>
<td>网关</td>
<td>对传输层到应用层的数据进行转换和转发的设备，通常会使用表示层或应用层的网关来处理不同协议之间的翻译和通信，代理服务器（proxy）就是应用网关的一种。</td>
</tr>
</tbody>
</table>
<h1 id="2-osi与tcp-ip参考模型">2. OSI与TCP/IP参考模型</h1>
<h2 id="2-1-osi与tcp-ip参考模型图">2.1. OSI与TCP/IP参考模型图</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579693/article/tcpip/basics/TCPIP-OSI.png" width=70%>
<h2 id="2-2-osi参考模型分层说明">2.2. OSI参考模型分层说明</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/osi-function.png" width=70%>
<h2 id="2-3-osi参考模型通信过程">2.3. OSI参考模型通信过程</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/OSI.png" width=70%>
<p>1、打包数据时，每一层在处理上一层传过来的数据时，会在数据上附上当前层的首部信息后传给下一层；</p>
<p>2、解包数据时，每一层在处理下一层传过来的数据时，会将当前层的首部信息与数据分开，将数据传给上一层。</p>
<p>3、数据通信过程</p>
<table>
<thead>
<tr>
<th>分层</th>
<th>每层的操作</th>
</tr>
</thead>
<tbody>
<tr>
<td>应用层</td>
<td>在数据前面加首部，首部包括数据内容、源地址和目标地址，同时也会处理异常的反馈信息。</td>
</tr>
<tr>
<td>表示层</td>
<td>将特有的数据格式转换为通用的数据格式，同时也会加上表示层的首部信息以供解析。</td>
</tr>
<tr>
<td>会话层</td>
<td>对何时连接，以何种方式连接，连接多久，何时断开等做记录。同时也会加会话层的首部信息。</td>
</tr>
<tr>
<td>传输层</td>
<td>建立连接，断开连接，确认数据是否发送成功和执行失败重发任务。</td>
</tr>
<tr>
<td>网络层</td>
<td>负责将数据发到目标地址，也包含首部信息。</td>
</tr>
<tr>
<td>数据链路层</td>
<td>通过物理的传输介质实现数据的传输。</td>
</tr>
<tr>
<td>物理层</td>
<td>将0/1转换成物理的传输介质，通过MAC地址进行传输。</td>
</tr>
</tbody>
</table>
<h2 id="2-4-tcp-ip应用层协议">2.4. TCP/IP应用层协议</h2>
<h3 id="2-4-1-通信模型">2.4.1. 通信模型</h3>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/TrafficModel.png" width=70%>
<h3 id="2-4-2-应用层协议说明">2.4.2. 应用层协议说明</h3>
<table>
<thead>
<tr>
<th>应用类型</th>
<th>协议</th>
<th>协议说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>WWW</td>
<td>HTTP,HTML</td>
<td><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579693/article/tcpip/basics/www.png" width=100%></td>
</tr>
<tr>
<td>电子邮件</td>
<td>SMTP，MIME</td>
<td><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579691/article/tcpip/basics/email.png" width=100%></td>
</tr>
<tr>
<td>文件传输</td>
<td>FTP</td>
<td><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579691/article/tcpip/basics/ftp.png" width=100%></td>
</tr>
<tr>
<td>远程登录</td>
<td>TELNET,SSH</td>
<td><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579693/article/tcpip/basics/telnet.png" width=100%></td>
</tr>
<tr>
<td>网络管理</td>
<td>SNMP,MIB</td>
<td><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/snmp.png" width=100%></td>
</tr>
</tbody>
</table>
<h1 id="3-tcp-ip通信过程">3. TCP/IP通信过程</h1>
<h2 id="3-1-数据包结构">3.1. 数据包结构</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579691/article/tcpip/basics/data-package.png" width=70%>
<h2 id="3-2-数据打包和解包过程">3.2. 数据打包和解包过程</h2>
<h3 id="3-2-1-包的封装">3.2.1. 包的封装</h3>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579692/article/tcpip/basics/package.png" width=60%> 
<h3 id="3-2-2-发送与接收">3.2.2. 发送与接收</h3>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579693/article/tcpip/basics/send-receive.png" width=60%>
<h2 id="3-3-数据包传输过程">3.3. 数据包传输过程</h2>
<img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579693/article/tcpip/basics/transmission.png" width=60%>
<p>文章：</p>
<ul>
<li>《图解TCP/IP》</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-f7cbb4c5a76ec9332d300cd3470493c2">2 - IP协议</h1>
    
	<h1 id="1-ip基础">1. IP基础</h1>
<p>TCP/IP的心脏是互联网层，这一层主要有IP和ICMP两个协议组成，在OSI参考模型中为第三层（网络层）。网络层的主要作用是实现终端节点之间的通信（点对点通信）。</p>
<h2 id="1-1-网络层与数据链路层的关系">1.1. 网络层与数据链路层的关系</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/1.1.png" alt="这里写图片描述"></p>
<h2 id="1-2-ip寻址">1.2. IP寻址</h2>
<p>IP地址用于在“连接到网络中的所有主机中识别出进行通信的目标地址”。因此TCP/IP通信中所有主机或路由器必须设定自己的IP地址（每块网卡至少配置一个或以上的IP地址）。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/1.2.png" alt="这里写图片描述"></p>
<h2 id="1-3-路由控制">1.3. 路由控制</h2>
<p>路由控制是指将分组数据发送到最终目标地址的功能。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/1.3.png" alt="这里写图片描述"></p>
<p>IP数据包类似快递中的包裹，送货车类似数据链路，包裹依赖送货车承载转运，而一辆送货车只能将包裹送到某个区间内，由新的快递点安排新的送货车来进行下一区间的运输。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/1.3.0.png" alt="这里写图片描述"></p>
<h3 id="1-3-1-路由控制表">1.3.1. 路由控制表</h3>
<p>为了将数据包发给目标主机，所有主机都维护一张路由控制表（Routing Table）,该表记录IP数据在下一步应该发给哪个路由器。IP包根据这个路由表在各个数据链路上传输。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/1.3.1.png" alt="这里写图片描述"></p>
<h2 id="1-4-数据链路的抽象化">1.4. 数据链路的抽象化</h2>
<p>IP是实现多个数据链路之间通信的协议。对不同数据链路的相异特性进行抽象化也是IP的重要作用之一。不同数据链路最大的区别在于它们各自的最大传输单位（MTU）不同，类似快递包裹有各自的大小限制。当数据包过大时，IP进行分片处理，即将大的IP包分成多个较小的IP包，当到目标地址后再被组合起来传给上一层。</p>
<h2 id="1-5-ip是面向无连接型">1.5. IP是面向无连接型</h2>
<p>IP发包之前不需要提前与目标建立连接。采用面向无连接的原因：为了简化和提速。面向连接型需要提前建立连接会降低处理速度。IP只负责将数据发给目标主机，但途中可能会发生丢包、错位、数据量翻倍等问题。TCP则是面向连接的协议，负责保证对端主机确实收到数据。</p>
<h1 id="2-ip地址">2. IP地址</h1>
<p>在TCP/IP通信中，用IP地址识别主机和路由器。</p>
<h2 id="2-1-ip地址的定义">2.1. IP地址的定义</h2>
<p>IP地址（IPv4地址）由32位正整数来表示。IP地址在计算机内部以二进制方式被处理，但习惯将32位的IP地址以8位为一组，分成4组，每组以“.”隔开，转换成10进制来表示。IPv4地址为32位，最多允许43亿台计算机连接网络。</p>
<p>实际上，IP地址并非根据主机台数来分配而是每一台主机上的每一块网卡都得设置IP地址，一块网卡可以设置一个或以上个IP,路由器通常会配置两个以上的网卡。</p>
<h2 id="2-2-ip地址由网络和主机两部分标识组成">2.2. IP地址由网络和主机两部分标识组成</h2>
<p>IP地址由“网络地址”和“主机地址”两部分组成。</p>
<p>网络标识在数据链路的每个段配置不同的值，必须保证相互连接的每个段的地址不重复，相同段内连接的主机必须有相同的网络地址。主机标识则不允许同一个网段内重复出现。在某一范围内，IP地址需具有唯一性。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579279/article/tcpip/ip/2.2.png" alt="这里写图片描述"></p>
<p>IP包被转发到某个路由器时，是利用目标IP地址的网络标识进行路由，即使不看主机地址，由网络地址则可判断是否是该网段内的主机。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579278/article/tcpip/ip/2.2.1.png" alt="这里写图片描述"></p>
<h2 id="2-3-ip地址的分类">2.3. IP地址的分类</h2>
<p>IP地址分为A、B、C、D四类。</p>
<table>
<thead>
<tr>
<th>IP地址类别</th>
<th>地址开头</th>
<th>网络地址</th>
<th>主机地址</th>
<th>范围</th>
<th>一个网段内主机地址个数</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>A类地址</td>
<td>0</td>
<td>第1-8位</td>
<td>后24位</td>
<td>0.0.0.0~127.0.0.0</td>
<td>2^24-2=16777214</td>
<td></td>
</tr>
<tr>
<td>B类地址</td>
<td>10</td>
<td>第1-16位</td>
<td>后16位</td>
<td>128.0.0.0~191.255.0.0</td>
<td>2^16-2=65534</td>
<td></td>
</tr>
<tr>
<td>C类地址</td>
<td>110</td>
<td>第1-24位</td>
<td>后8位</td>
<td>192.0.0.0~239.255.255.0</td>
<td>2^8-2=254</td>
<td></td>
</tr>
<tr>
<td>D类地址</td>
<td>1110</td>
<td>第1-32位</td>
<td>没有主机地址</td>
<td>224.0.0.0~239.255.255.255</td>
<td></td>
<td>常用于多播</td>
</tr>
</tbody>
</table>
<p>注意：同一个网段中的主机地址分配，主机地址全为0表示对应的网络地址，主机地址全为1通常用于广播地址。因此一个网段内主机的个数去掉2个（例如2^8-2=254）。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579279/article/tcpip/ip/2.3.png" alt="这里写图片描述"></p>
<h2 id="2-4-子网隐码">2.4. 子网隐码</h2>
<p>用1表示网络地址的范围，用0表示主机地址的访问。因此A、B、C类可表示为</p>
<table>
<thead>
<tr>
<th>IP类别</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>A类</td>
<td>255.0.0.0</td>
</tr>
<tr>
<td>B类</td>
<td>255.255.0.0</td>
</tr>
<tr>
<td>C类</td>
<td>255.255.255.0</td>
</tr>
</tbody>
</table>
<p>按照以上的组合方式IP有点浪费，因此产生子网隐码的分类方法减少这种浪费。</p>
<p>引入子网后，IP地址由两种识别码组成：IP地址本身+表示网络地址的子网隐码。即将A,B,C类中的主机地址拆成网络部分和主机部分，重新分配网络地址和主机地址。子网隐码同样是用1表示网络地址的范围，用0表示主机地址的访问。</p>
<h3 id="2-4-1-子网隐码的表示方法">2.4.1. 子网隐码的表示方法</h3>
<table>
<thead>
<tr>
<th>表示方法</th>
<th>地址</th>
<th></th>
<th>子网隐码</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>数字</td>
<td>IP地址</td>
<td>172.20.100.52</td>
<td>255.255.255.192</td>
<td></td>
</tr>
<tr>
<td>网络地址</td>
<td>172.20.100.0</td>
<td>255.255.255.192</td>
<td></td>
<td></td>
</tr>
<tr>
<td>广播地址</td>
<td>172.20.100.63</td>
<td>255.255.255.192</td>
<td></td>
<td></td>
</tr>
<tr>
<td>“/26”，表示前26位为网络地址</td>
<td>IP地址</td>
<td>172.20.100.52/26</td>
<td></td>
<td></td>
</tr>
<tr>
<td>网络地址</td>
<td>172.20.100.0/26</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>广播地址</td>
<td>172.20.100.63/26</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579279/article/tcpip/ip/2.4.1.png" alt="这里写图片描述"></p>
<h1 id="3-路由控制">3. 路由控制</h1>
<p>发送数据包除了有目标IP地址外，还需要指明路由器和主机的信息，即路由控制表。</p>
<p>路由控制表的形成方式有两种：</p>
<p>1、静态路由</p>
<p>由管理员手动设置</p>
<p>2、动态路由</p>
<p>路由器与其他路由器相互交互信息时自动刷新。为了让动态路由及时刷新路由表，在网络上互联的路由器之间需设置路由协议，保证正常读取路由控制信息。</p>
<h2 id="3-1-ip地址和路由控制">3.1. IP地址和路由控制</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579279/article/tcpip/ip/3.1.png" alt="这里写图片描述"></p>
<p>IP地址的网络地址部分用于进行路由控制。路由控制表中记录着网络地址与下一步应该发送至路由器的地址。在发送IP包时，首先确认IP包首部中的目标地址，再从路由控制表中找到与该地址具有相同网络地址的记录，根据该记录将IP包转发给相应的下一个路由器。如果存在多条相同网络地址的记录，则选择最为吻合的网络地址（相同位数最多）。例如：172.20.100.52的网络地址与172.20.0/16和172.20.100.0/24都匹配，则选择匹配最长的172.20.100.0/24。</p>
<h3 id="3-1-1-默认路由">3.1.1. 默认路由</h3>
<p>默认路由一般标记为0.0.0.0/0或default。当路由表中没有任何一个地址与之匹配的记录，则使用默认路由。</p>
<h3 id="3-1-2-主机路由">3.1.2. 主机路由</h3>
<p>“IP地址/32”也被称为主机路由，即整个IP地址的所有位都参与路由。进行主机路由意味着基于主机上网卡配置的IP地址本身而不是基于该地址的网络地址进行路由。一般用于不希望通过网络地址路由的情况。使用主机路由会导致路由表膨大，路由负荷增加，网络性能下降。</p>
<h3 id="3-1-3-环回地址">3.1.3. 环回地址</h3>
<p>环回地址是在同一台计算机上程序之间进行网络通信时所使用的一个默认地址。即IP地址为127.0.0.1，主机名为localhost。</p>
<h2 id="3-2-路由控制表的聚合">3.2. 路由控制表的聚合</h2>
<p>路由信息的聚合可以有效的减少路由表的条目。路由表越大，管理它所需要的内存和CPU就越多，查找路由表的时间越长，导致转发IP包性能下降。要构建高性能网络就需要尽可能减少路由表的大小。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579280/article/tcpip/ip/3.2.png" alt="这里写图片描述"></p>
<h1 id="4-ip首部信息">4. IP首部信息</h1>
<p>IP进行通信时，需要在数据前面加入IP首部信息，IP首部包含着用于IP协议进行发包控制时所有的必要信息。</p>
<h2 id="4-1-ipv4首部">4.1. IPv4首部</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579280/article/tcpip/ip/4.1.png" alt="这里写图片描述"></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
<th>大小</th>
</tr>
</thead>
<tbody>
<tr>
<td>版本</td>
<td>标识IP首部的版本号，IPv4，即版本号为4</td>
<td>4比特</td>
</tr>
<tr>
<td>首部长度</td>
<td>表示IP首部的大小，单位为4字节</td>
<td>4比特</td>
</tr>
<tr>
<td>区分服务</td>
<td>表示服务质量</td>
<td>8比特</td>
</tr>
<tr>
<td>DSCP段与ECN段</td>
<td>DSCP用来进行质量控制，值越大优先度越高；ECN用来报告网络拥堵情况</td>
<td>2比特</td>
</tr>
<tr>
<td>总长度</td>
<td>表示IP首部与数据部分合起来的总字节数</td>
<td>16比特</td>
</tr>
<tr>
<td>标识</td>
<td>用于分片重组，同一个分片标识值相同，不同分片的标识值不同</td>
<td>16比特</td>
</tr>
<tr>
<td>标志</td>
<td>表示包被分片的相关信息</td>
<td>3比特</td>
</tr>
<tr>
<td>片偏移</td>
<td>用来标识被分片的每一个分段相对于原始数据的位置。</td>
<td>13比特</td>
</tr>
<tr>
<td>生存时间（TTL）</td>
<td>本意为包的生存期限，一般表示可以中转多少个路由器，每经过一个路由器TTL减1，直到变为0则丢弃该包</td>
<td>8比特</td>
</tr>
<tr>
<td>协议</td>
<td>表示IP首部的下一个首部隶属于哪个协议。</td>
<td>8比特</td>
</tr>
<tr>
<td>首部校验和</td>
<td>IP首部校验和，用来确保IP数据报不被破坏。</td>
<td>16比特</td>
</tr>
<tr>
<td>源地址</td>
<td>发送端IP地址</td>
<td>32比特</td>
</tr>
<tr>
<td>目标地址</td>
<td>接收端IP地址</td>
<td>32比特</td>
</tr>
<tr>
<td>可选项</td>
<td>安全级别、源路径、路径记录、时间戳</td>
<td></td>
</tr>
<tr>
<td>填充</td>
<td>填补物，调整大小使用</td>
<td></td>
</tr>
<tr>
<td>数据</td>
<td>存入数据</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="4-2-ipv6首部">4.2. IPv6首部</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579280/article/tcpip/ip/4.2.png" alt="这里写图片描述"></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>版本</td>
<td>IPv6,版本为6</td>
</tr>
<tr>
<td>通信量类</td>
<td>相当于IPv4的TOS（Type Of Service）字段</td>
</tr>
<tr>
<td>流标号</td>
<td>用于服务质量控制</td>
</tr>
<tr>
<td>有效载荷长度</td>
<td>包的数据部分</td>
</tr>
<tr>
<td>下一个首部</td>
<td>相当于IPv4的协议字段</td>
</tr>
<tr>
<td>跳数限制</td>
<td>Hop Limit，同IPv4的TTL,表示可通过的路由器个数</td>
</tr>
<tr>
<td>源地址</td>
<td>发送端的IP地址</td>
</tr>
<tr>
<td>目标地址</td>
<td>接收端的IP地址</td>
</tr>
</tbody>
</table>
<p><br/>参考</p>
<ul>
<li>《图解TCP/IP》</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-783f0fab77205aefe1fd803e53ba7c52">3 - TCP协议</h1>
    
	<h1 id="1-传输层的作用">1. 传输层的作用</h1>
<h2 id="1-1-传输层的定义">1.1. 传输层的定义</h2>
<p>IP首部有个协议字段，用来标识传输层协议，识别数据是TCP的内容还是UDP的内容。同样，传输层，为了识别数据应该发给哪个应用也设定了这样的编号，即端口。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579309/article/tcpip/tcpudp/1.1.png" alt="这里写图片描述"></p>
<h2 id="1-2-通信处理">1.2. 通信处理</h2>
<p>应用协议大多以C/S形式运行，即服务端需提前启动服务，监听某个端口，当客户端往该端口发送数据时，可以及时处理请求。</p>
<p>服务端程序在UNIX系统中称为守护进程，例如HTTP的服务端程序为httpd；ssh的服务端程序为sshd。UNIX中不必要逐个启动这些守护进程，而是由超级守护进程inetd(互联网守护进程)启动，当收到客户端请求时会创建（fork）新的进程并转换（exec）为httpd等各个守护进程。根据请求端口分配到对应的服务端守护进程上处理。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579310/article/tcpip/tcpudp/1.2.png" alt="这里写图片描述"></p>
<h2 id="1-3-tcp和udp">1.3. TCP和UDP</h2>
<h3 id="1-3-1-tcp">1.3.1. TCP</h3>
<p>TCP是面向连接、可靠的数据流。流就是不间断的数据结构，可理解为水管中的水流。虽然可以保证发送顺序，但犹如没有间隔的发送数据流给接收端。例如：发送10次100字节的消息，接收端可能会收到一个1000字节连续不断的数据。TCP为实现可靠传输，实行“顺序控制”和“重发控制”；还具备“流量控制”、“拥塞控制”、提高网络利用率等。TCP可以类比为“打电话”，有去有回。</p>
<h3 id="1-3-2-udp">1.3.2. UDP</h3>
<p>UDP是不具备可靠性的数据报协议，可以确保发送消息的大小，但不能保证消息一定到达，应用有时会根据自己的需要进行重发处理。UDP可以类比“发短信”，有去无回。</p>
<h3 id="1-3-3-套接字">1.3.3. 套接字</h3>
<p>应用在使用TCP或UDP时会用到系统提供的类库，即API（应用编程接口），通信时会用到套接字（socket）的API。应用程序利用套接字，可以设置对端的IP地址、端口号，并实现数据的发送与接收。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579309/article/tcpip/tcpudp/1.3.3.png" alt="这里写图片描述"></p>
<h1 id="2-端口号">2. 端口号</h1>
<h2 id="2-1-端口号的定义">2.1. 端口号的定义</h2>
<table>
<thead>
<tr>
<th>类别</th>
<th>地址</th>
<th>层</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>端口号</td>
<td>程序地址</td>
<td>传输层</td>
<td>同一个计算机中不同的应用程序</td>
</tr>
<tr>
<td>IP地址</td>
<td>主机地址</td>
<td>网络层</td>
<td>识别TCP/IP网络中不同的主机或路由器</td>
</tr>
<tr>
<td>MAC地址</td>
<td>物理地址</td>
<td>数据链路层</td>
<td>在同一个数据链路中识别不同的计算机</td>
</tr>
</tbody>
</table>
<p>把数据传输比作快递传递；IP地址就像你的家庭地址；那么端口号相当于你家具体的收件人；知道了家庭地址和收件人才能将快递准确送达。</p>
<h2 id="2-2-根据端口号识别应用">2.2. 根据端口号识别应用</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579309/article/tcpip/tcpudp/2.2.png" alt="这里写图片描述"></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579309/article/tcpip/tcpudp/2.2.1.png" alt="这里写图片描述"></p>
<h2 id="2-3-通过ip地址-端口号-协议号进行通信">2.3. 通过IP地址、端口号、协议号进行通信</h2>
<p>5个信息唯一标识一个通信：源地址IP、目标地址IP、协议号、源端口号、目标端口号。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579310/article/tcpip/tcpudp/2.3.png" alt="这里写图片描述"></p>
<h2 id="2-4-端口号如何确定">2.4. 端口号如何确定</h2>
<h3 id="2-4-1-标准既定的端口号">2.4.1. 标准既定的端口号</h3>
<p>该方法也叫静态方法，是指每个应用程序都有其指定的端口号。例如HTTP、FTP等应用协议使用的端口号，这类端口号称为知名端口号，一般由0-1023的数字分配而成。除知名端口号外，还有一些端口号也被正式注册，分布在1024-49151的数字之间。这些端口可用于任何通信用途。</p>
<h3 id="2-4-2-时序分配法">2.4.2. 时序分配法</h3>
<p>该方法也叫动态分配法，服务端有必要确定监听端口号，但接受服务的客户端没必要确定端口号。客户端可以不用自己设置端口号，由操作系统进行分配。操作系统为每个应用程序分配互不冲突的端口号。例如，新增一个端口号则在之前的端口号上加1，动态分配的端口号取值范围：49152-65535。</p>
<h1 id="3-tcp协议概述">3. TCP协议概述</h1>
<p>TCP:Transmission Control Protocol (传输控制协议)，TCP实现了数据传输时的各种控制功能，可以进行丢包重发，乱序纠正，控制通信流量的浪费。</p>
<p>参考：</p>
<ul>
<li>《图解TCP/IP》</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-84452cfe31915d8c4f4d04258246cb10">4 - UDP协议</h1>
    
	<h1 id="1-udp协议概述">1. UDP协议概述</h1>
<p>UDP:User Datagram Protocol的缩写，提供面向无连接的通信服务，在应用程序发来数据收到那一刻则立即原样发送到网络上。即使出现丢包也不负责重发，包出现乱序也不能纠正。</p>
<p>UDP可以随时发送数据，本身处理简单高效，但不具备可靠性，适合以下场景：</p>
<ul>
<li>包总量较少的通信（DNS、SNMP等）</li>
<li>视频、音频等多媒体通信（即使通信）</li>
<li>限定于LAN等特定网络中的应用通信</li>
<li>广播通信（广播、多播）</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0890a784034f82778864893ae61492de">5 - HTTP协议</h1>
    
	<h1 id="1-web及网络基础">1. web及网络基础</h1>
<h2 id="1-1-通过http访问web-c-s">1.1. 通过HTTP访问web[C/S]</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/1.1.png" alt=""></p>
<h2 id="1-2-tcp-ip四层模型">1.2. TCP/IP四层模型</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/1.2.png" alt=""></p>
<h3 id="1-2-1-数据包的封装">1.2.1. 数据包的封装</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/1.2.1.png" alt=""></p>
<h2 id="1-3-tcp-ip协议族">1.3. TCP/IP协议族</h2>
<h3 id="1-3-1-负责传输的ip协议">1.3.1. 负责传输的IP协议</h3>
<p>使用ARP协议凭借MAC地址通信</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/1.3.1.png" alt=""></p>
<h3 id="1-3-2-确保可靠的tcp协议">1.3.2. 确保可靠的TCP协议</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/1.3.2.png" alt=""></p>
<h3 id="1-3-3-负责域名解析的dns服务">1.3.3. 负责域名解析的DNS服务</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/1.3.3.png" alt=""></p>
<h3 id="1-3-4-各协议与http的关系">1.3.4. 各协议与HTTP的关系</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/1.3.4.png" alt=""></p>
<h2 id="1-4-uri与url">1.4. URI与URL</h2>
<ul>
<li>URI(Uniform Resource Identifier):统一资源标识符</li>
<li>URL(Uniform Resource Locator):统一资源定位符；URL是URI的子集</li>
</ul>
<h3 id="1-4-1-uri的格式">1.4.1. URI的格式</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/1.4.1.png" alt=""></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>协议</td>
<td>http/https</td>
</tr>
<tr>
<td>登录信息（认证）</td>
<td>user:pass@(一般没有)</td>
</tr>
<tr>
<td>服务器地址</td>
<td>域名或IP</td>
</tr>
<tr>
<td>服务器端口号</td>
<td>服务端口号，省略则取默认端口号</td>
</tr>
<tr>
<td>带层次的文件路径</td>
<td>指定服务器上的文件路径来定位特指的资源</td>
</tr>
<tr>
<td>查询字符串</td>
<td>使用查询字符串传入参数</td>
</tr>
<tr>
<td>片段标识符</td>
<td>标记以获取资源中的子资源（文档内的某个位置）</td>
</tr>
</tbody>
</table>
<h3 id="1-4-2-uri的示例">1.4.2. URI的示例</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/1.4.2.png" alt=""></p>
<h1 id="2-http协议">2. HTTP协议</h1>
<h2 id="2-1-通过请求和响应的交换达成通信">2.1. 通过请求和响应的交换达成通信</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/2.1.png" alt=""></p>
<h3 id="2-1-1-请求报文">2.1.1. 请求报文</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579775/article/tcpip/http/basis/2.1.1.png" alt=""></p>
<h3 id="2-1-2-响应报文">2.1.2. 响应报文</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/2.1.2.png" alt=""></p>
<h2 id="2-2-http请求方法">2.2. HTTP请求方法</h2>
<h3 id="2-2-1-get-获取资源">2.2.1. GET:获取资源</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/2.2.1.png" alt=""></p>
<h3 id="2-2-2-post-传输实体主体">2.2.2. POST:传输实体主体</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.2.1.png" alt=""></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579776/article/tcpip/http/basis/2.2.2.2.png" alt=""></p>
<h3 id="2-2-3-put-传输文件">2.2.3. PUT:传输文件</h3>
<p>PUT方法用来传输文件，像FTP协议一样，要求在请求报文的主体中包含文件内容，然后保存到请求URI指定的位置。</p>
<p>因为自身不带验证机制，有安全问题，因此一般不采用。若配合验证机制或者REST标准则可使用。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.3.png" alt=""></p>
<h3 id="2-2-4-head-获取报文头部">2.2.4. HEAD:获取报文头部</h3>
<p>HEAD和GET一样但不返回报文主体部分，用于确认URI的有效性及资源的更新时间等。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.4.png" alt=""></p>
<h3 id="2-2-5-delete-删除文件">2.2.5. DELETE:删除文件</h3>
<p>DELETE与PUT作用相反，但不带安全验证机制一般不采用。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.5.1.png" alt=""></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.5.2.png" alt=""></p>
<h3 id="2-2-6-options-询问支持的方法">2.2.6. OPTIONS:询问支持的方法</h3>
<p>OPTIONS用来查询针对请求URI指定的资源支持的方法</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.6.png" alt=""></p>
<h3 id="2-2-7-trace-追踪路径">2.2.7. TRACE:追踪路径</h3>
<p>TRACE用来查询发送出去的请求是怎样被加工修改/篡改的，因为易引发XST（跨站追踪）攻击，一般不使用。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.7.png" alt=""></p>
<h3 id="2-2-8-connect-要求用隧道协议连接代理">2.2.8. CONNECT:要求用隧道协议连接代理</h3>
<p>CONNECT要求在与代理服务器通信时建立隧道，实现用隧道协议进行TCP通信。主要使用SSL（Source Sockets Layer:安全套接字）和TLS（Transport Layer Security:传输层安全）协议把通信内容加密后经网络隧道传输。</p>
<p>方法格式如下：</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579777/article/tcpip/http/basis/2.2.8.1.png" alt=""></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.2.8.2.png" alt=""></p>
<h2 id="2-3-持久连接">2.3. 持久连接</h2>
<h3 id="2-3-1-keep-alive">2.3.1. keep-alive</h3>
<p>为解决每进行一次HTTP通信就要断开一次TCP连接，增加了通信量的开销，HTTP/1.1通过keep-alive持久连接，只要任意一端没有明确提出断开连接，则保持TCP连接状态。</p>
<p>持久连接减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.3.1.png" alt=""></p>
<h3 id="2-3-2-管线化">2.3.2. 管线化</h3>
<p>持续连接使得多数请求以管线化（pipelining）方式发送成为可能。管线化即同时并行发送多个请求，而不需要一个接一个等待响应。管线化技术比持续连接速度快，请求数越多越明显。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.3.2.png" alt=""></p>
<h3 id="2-3-3-使用cookie的状态管理">2.3.3. 使用cookie的状态管理</h3>
<p>HTTP是无状态协议，不对之前发生过的请求和响应的状态进行管理，即无法根据之前的状态进行本次的请求处理。无状态协议的优点在于不必保存状态，减少服务器CPU及内存资源的消耗。</p>
<p>cookie技术通过在请求和响应报文中写入cookie信息来控制客户端的状态。cookie会根据从服务端发送的响应报文内的一个叫做Set-Cookie的首部字段通知客户端保存Cookie；当客户端再往服务端发送请求时，客户端自动在请求报文中加入Cookie值后发送出去。服务器发现Cookie后会检查从哪个客户端发送来的连接请求，对比服务器上的记录，最后得到之前的状态信息。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.3.3.png" alt=""></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.3.3.2.png" alt=""></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510579778/article/tcpip/http/basis/2.3.3.3.png" alt=""></p>
<h1 id="3-http报文">3. HTTP报文</h1>
<h2 id="3-1-http报文">3.1. HTTP报文</h2>
<p>用于HTTP协议交互的信息被称为HTTP报文，客户端的HTTP报文叫做请求报文，服务端的叫做响应报文。报文大致分为报文首部和报文主体，但并不一定要有报文主体。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580019/article/tcpip/http/codestatus/3.1.png" alt="img"></p>
<h2 id="3-2-报文结构">3.2. 报文结构</h2>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580019/article/tcpip/http/codestatus/3.2.png" alt="img"></p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/3.2.2.png" alt="img"></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>请求行</td>
<td>请求方法，请求URI和HTTP版本</td>
</tr>
<tr>
<td>状态行</td>
<td>响应结果的状态码，原因短语和HTTP版本</td>
</tr>
<tr>
<td>首部字段</td>
<td>请求和响应的各种条件和属性的各类首部：通用首部、请求首部、响应首部、实体首部</td>
</tr>
<tr>
<td>其他</td>
<td>HTTP的RFC里未定义的首部（Cookie等）</td>
</tr>
</tbody>
</table>
<h2 id="3-3-编码提升传输速率">3.3. 编码提升传输速率</h2>
<p>HTTP在传输数据时可以按照数据原貌直接传输也可以在传输过程中编码提升传输速率；通过编码可以处理大量请求但会消耗更多的CPU等资源。</p>
<h3 id="3-3-1-报文主体和实体主体的差异">3.3.1. 报文主体和实体主体的差异</h3>
<ul>
<li>报文：是HTTP通信中的基本单位，由8位组字节流组成，通过HTTP通信传输。</li>
<li>实体：作为请求或响应的有效载荷数据被传输，其内容由实体首部和实体主体组成。</li>
</ul>
<p>通常报文主体等于实体主体，但当传输中进行编码时，实体主体的内容发生变化才会与报文主体产生差异。</p>
<h3 id="3-3-2-压缩传输的内容编码">3.3.2. 压缩传输的内容编码</h3>
<p>HTTP中的内容编码指明应用在实体内容上的编码格式，并保持实体信息原样压缩，内容编码后的实体由客户端接收并负责解码。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580019/article/tcpip/http/codestatus/3.3.2.png" alt="img"></p>
<p>常用的内容编码：</p>
<ul>
<li>gzip(GNU ZIP)</li>
<li>compress(UNIX系统的标准压缩)</li>
<li>deflate(zlib)</li>
<li>identity(不进行编码)</li>
</ul>
<h3 id="3-3-3-分块传输编码">3.3.3. 分块传输编码</h3>
<p>分块传输编码会将实体主体分成多个块，每一块都会用十六进制来标记快的大小，而实体的最后一块会使用“0（CR+LF）”来标记。</p>
<p>由接收的客户端负责解码，回复到编码前的实体主体。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/3.3.3.png" alt="img"></p>
<h2 id="3-4-发送多种数据的多部分对象集合">3.4. 发送多种数据的多部分对象集合</h2>
<p>HTTP中的多部分对象集合即发送一份报文主体内可含有多类型实体，通常是图片或文本文件上传等。</p>
<p>多部分对象集合包含的对象：</p>
<ul>
<li>multipart/form-data:在web表单文件上传时使用</li>
<li>multipart/byteranges：状态码206响应报文包含了多个范围的内容时使用</li>
</ul>
<h2 id="3-5-获取部分内容的范围请求">3.5. 获取部分内容的范围请求</h2>
<p>指定范围发送的请求叫做范围请求，对于一份10000字节大小的资源，如果使用范围请求，可以只请求5001-10000字节内的资源。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/3.5.png" alt="img"></p>
<p>执行范围请求时，会用到首部字段Range来指定资源的byte范围</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/3.5.2.png" alt="img"></p>
<h2 id="3-6-内容协商返回最合适的内容">3.6. 内容协商返回最合适的内容</h2>
<p>内容协商机制是指客户端和服务端就响应的资源内容进行交涉，然后提供给客户端最合适的资源。内容协商会以响应资源的语言、编码方式等作为判断的基准。</p>
<p>内容协商类型：</p>
<ul>
<li>服务器驱动协商</li>
<li>客户端驱动协商</li>
<li>透明协商</li>
</ul>
<h1 id="4-http状态码">4. HTTP状态码</h1>
<p>状态码即服务器返回的请求结果。</p>
<table>
<thead>
<tr>
<th>状态码</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1xx</td>
<td>Informational(信息性状态码)</td>
<td>接收的请求正在处理</td>
</tr>
<tr>
<td>2xx</td>
<td>Success(成功)</td>
<td>请求正常处理完毕</td>
</tr>
<tr>
<td>3xx</td>
<td>Redirection(重定向)</td>
<td>需要进行附加操作以完成请求</td>
</tr>
<tr>
<td>4xx</td>
<td>Client Error(客户端错误)</td>
<td>服务器无法处理请求</td>
</tr>
<tr>
<td>5xx</td>
<td>Server Error(服务端错误)</td>
<td>服务器处理请求出错</td>
</tr>
</tbody>
</table>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580022/article/tcpip/http/codestatus/4.png" alt="img"></p>
<h2 id="4-1-2xx成功">4.1. 2XX成功</h2>
<h3 id="4-1-1-200-ok">4.1.1. 200 OK</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/4.1.1.png" alt="img"></p>
<h3 id="4-1-2-204-no-content">4.1.2. 204 No Content</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/4.1.2.png" alt="img"></p>
<p>表示请求已成功处理，但在返回的响应报文中不含实体的主体部分。</p>
<h3 id="4-1-3-206-partial-content">4.1.3. 206 Partial Content</h3>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/4.1.3.png" alt="img"></p>
<p>该状态码表示客户端进行了范围请求，服务器成功执行了这部分的GET请求。响应报文中包含由Content-Range指定范围的实体内容。</p>
<h2 id="4-2-3xx-重定向">4.2. 3XX 重定向</h2>
<h3 id="4-2-1-301-moved-permanently">4.2.1. 301 Moved Permanently</h3>
<p>永久性重定向，表示资源已被分配了新的URI，以后应使用新的URI。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/4.2.1.png" alt="img"></p>
<h3 id="4-2-2-302-found">4.2.2. 302 Found</h3>
<p>临时性重定向，表示请求的资源已被分配了新的URI，但是临时性的。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.2.2.png" alt="img"></p>
<h3 id="4-2-3-303-see-other">4.2.3. 303 See Other</h3>
<p>表示由于请求的资源存在另一个URI，应使用GET方法重定向获取请求的资源。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580020/article/tcpip/http/codestatus/4.2.3.png" alt="img"></p>
<h3 id="4-2-4-304-not-modified">4.2.4. 304 Not Modified</h3>
<p>表示客户端发送附带条件的请求时（GET中的If-Modified-Since等首部），服务器允许访问资源，但未满足附带条件因此直接返回304（服务器的资源未改变，可直接使用客户端未过期的缓存），不包含任何响应的主体部分。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.2.4.png" alt="img"></p>
<h3 id="4-2-5-307-temporary-redirect">4.2.5. 307 Temporary Redirect</h3>
<p>临时重定向，该状态与302有相同的含义。</p>
<h2 id="4-3-4xx-客户端错误">4.3. 4XX 客户端错误</h2>
<h3 id="4-3-1-400-bad-request">4.3.1. 400 Bad Request</h3>
<p>表示请求报文中存在语法错误，需修改内容重新发送请求。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.3.1.png" alt="img"></p>
<h3 id="4-3-2-401-unauthorized">4.3.2. 401 Unauthorized</h3>
<p>表示需要通过HTTP认证。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.3.2.png" alt="img"></p>
<h3 id="4-3-3-403-forbidden">4.3.3. 403 Forbidden</h3>
<p>表示请求被服务器拒绝，未获得访问授权。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.3.3.png" alt="img"></p>
<h3 id="4-3-4-404-no-found">4.3.4. 404 No Found</h3>
<p>表明服务器上找不到请求的资源，也可以在服务器拒绝请求且不想说明理由时使用。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.3.4.png" alt="img"></p>
<h2 id="4-4-5xx-服务器错误">4.4. 5XX 服务器错误</h2>
<h3 id="4-4-1-500-internal-server-error">4.4.1. 500 Internal Server Error</h3>
<p>表明服务器在执行请求时发生了错误，也可能是Web应用存在bug或临时故障等。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580021/article/tcpip/http/codestatus/4.4.1.png" alt="img"></p>
<h3 id="4-4-2-503-service-unavailable">4.4.2. 503 Service Unavailable</h3>
<p>表明服务器暂时处于超负荷或正在进行停机维护，现在不能处理请求。</p>
<p><img src="https://res.cloudinary.com/dqxtn0ick/image/upload/v1510580022/article/tcpip/http/codestatus/4.4.2.png" alt="img"></p>
<p>参考：</p>
<ul>
<li>《图解HTTP》</li>
</ul>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/huweihuang/blog.huweihuang.com" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 www.huweihuang.com 保留所有权利</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">隐私政策</a></small>
	
		<p class="mt-2"><a href="/about/">About</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




















<script src="/js/main.min.91798a335c881f1b6b805085ba4aa22d1dbd2b0b18d105d05189fa104ddae350.js" integrity="sha256-kXmKM1yIHxtrgFCFukqiLR29KwsY0QXQUYn6EE3a41A=" crossorigin="anonymous"></script>



<script src='/js/prism.js'></script>



  </body>
</html>
